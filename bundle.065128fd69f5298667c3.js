!function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};e.m=t,e.c=a,e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,a){"use strict";function n(t){(t||window.event).preventDefault()}function i(){var t=f.getElementsByClassName("active")[0];t&&t.classList.remove("active")}function r(t){n(t);var e=t.dataTransfer.files[0],a=new FileReader;/image/.test(e.type)&&(this.classList.add("active"),a.onload=function(){console.log(e);var t=new Image;t.onload=function(){var e=this.width,a=this.height;h.classList.remove("init"),p.classList.add("active"),i(),h.width=e,h.height=a,y.drawImage(t,0,0,e,a),w=new v.default(this)},t.src=a.result},a.readAsDataURL(e))}function l(t){var e=t.target||t.srcElement;if("li"===e.tagName.toLocaleLowerCase()){var a=e.getAttribute("data-filter");w&&(i(),y.putImageData(w[a](),0,0),console.log("apply "+a),e.classList.add("active"))}}function s(){for(var t=p.getElementsByTagName("input"),e=[],a=void 0,n=0,r=t.length;n<r;n++)a=t[n].value-0,Number.isNaN(a)&&(a=0),t[n].value=a,e.push(a);i(),y.putImageData(w.conv(e),0,0)}function o(t){var e=t.target||t.srcElement;"input"===e.tagName.toLocaleLowerCase()&&(e.value=e.value.replace(/[^\+\/\-\d\.]*/g,""))}function c(t){"input"===(t.target||t.srcElement).tagName.toLocaleLowerCase()&&13===t.keyCode&&s.apply(this)}a(1);var u=a(2),v=function(t){return t&&t.__esModule?t:{default:t}}(u);a(3);var d=function(t){return"string"==typeof t?document.getElementById(t):t},h=d("canvas"),g=d("wrapper"),f=d("filter-li"),p=d("mat-con"),m=d("apply-btn"),y=h.getContext&&h.getContext("2d"),w=null;f.addEventListener("click",l,!1),g.addEventListener("dragenter",n,!1),g.addEventListener("dragover",n,!1),g.addEventListener("drop",r,!1),p.addEventListener("input",o,!1),p.addEventListener("keyup",c,!1),m.addEventListener("click",s,!1)},function(t,e){},function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),r=function(){function t(e){n(this,t),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.img=e,this.width=e.width,this.height=e.height,this.canvas.width=e.width,this.canvas.height=e.height,this.ctx.drawImage(this.img,0,0,this.width,this.height)}return i(t,[{key:"getImageData",value:function(t,e,a,n){return this.ctx.getImageData(t||0,e||0,a||this.width,n||this.height)}},{key:"copyImageData",value:function(t){t=t||this.getImageData();var e=document.createElement("canvas"),a=e.getContext("2d"),n=t.width,i=t.height;return e.width=n,e.height=i,a.putImageData(t,0,0),a.getImageData(0,0,n,i)}},{key:"greyScale",value:function(t){t=t||this.getImageData();for(var e=t.data,a=void 0,n=void 0,i=void 0,r=void 0,l=0,s=e.length;l<s;l+=4)a=e[l],n=e[l+1],i=e[l+2],r=.299*a+.587*n+.114*i,e[l]=e[l+1]=e[l+2]=r;return t}},{key:"black",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;t=t||this.getImageData();for(var a=t.data,n=void 0,i=0,r=a.length;i<r;i+=4)n=.3*a[i]+.6*a[i+1]+.1*a[i+2]>=e?255:0,a[i]=a[i+1]=a[i+2]=n;return t}},{key:"comic",value:function(t){t=t||this.getImageData();for(var e=t.data,a=void 0,n=void 0,i=void 0,r=0,l=e.length;r<l;r+=4)a=e[r],n=e[r+1],i=e[r+2],e[r]=Math.abs(n-i+n+a)*a/256,e[r+1]=Math.abs(i-n+a+i)*a/256,e[r+2]=Math.abs(i-n+a+i)*n/256;return t}},{key:"sepia",value:function(t){t=t||this.getImageData();for(var e=t.data,a=void 0,n=void 0,i=void 0,r=0,l=e.length;r<l;r+=4)a=e[r],n=e[r+1],i=e[r+2],e[r]=.393*a+.769*n+.189*i,e[r+1]=.349*a+.686*n+.168*i,e[r+2]=.272*a+.534*n+.131*i;return t}},{key:"invert",value:function(t){t=t||this.getImageData();for(var e=t.data,a=0,n=e.length;a<n;a+=4)e[a]=255-e[a],e[a+1]=255-e[a+1],e[a+2]=255-e[a+2];return t}},{key:"brightness",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;t=t||this.getImageData();for(var a=t.data,n=0,i=a.length;n<i;n+=4)a[n]+=e,a[n+1]+=e,a[n+2]+=e;return t}},{key:"sharpen",value:function(t){return t=t||this.getImageData(),this.conv([0,-1,0,-1,5,-1,0,-1,0],t)}},{key:"edgeDetection",value:function(t){return t=t||this.getImageData(),this.conv([-1,-1,-1,-1,8,-1,-1,-1,-1],this.gaussBlur(t))}},{key:"embossing",value:function(t){return t=t||this.getImageData(),this.conv([1,1,1,1,.7,-1,-1,-1,-1],t)}},{key:"gaussBlur",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t=t||this.getImageData();for(var n=2*e+1,i=-1/(2*a*a),r=-i/Math.PI,l=new Array(n*n),s=0,o=-e,c=0;o<=e;o++)for(var u=-e;u<=e;u++,c++)l[c]=r*Math.exp(i*(o*o+u*u)),s+=l[c];return this.conv(l,t,n,s)}},{key:"sketch",value:function(t){t=t||this.getImageData();for(var e=this.greyScale(t),a=this.invert(this.copyImageData(e)),n=this.gaussBlur(a),i=e.data,r=n.data,l=void 0,s=void 0,o=void 0,c=void 0,u=0,v=i.length;u<v;u+=4)for(var d=0;d<3;d++)c=u+d,l=i[c],s=r[c],o=l+l*s/(255-s),o=o>255?255:o,i[c]=o;return e}},{key:"conv",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e=e||this.getImageData();for(var i=e.data,r=this.width,l=this.height,s=this.ctx.createImageData(r,l),o=s.data,c=Math.floor(a/2),u=0;u<l;u++)for(var v=0;v<r;v++){for(var d=0;d<3;d++){var h=4*(u*r+v)+d;if(v<c||u<c||v>=r-c||u>=l-c)o[h]=i[h];else{for(var g=0,f=0,p=-c;p<=c;p++)for(var m=h+4*r*p,y=-c;y<=c;y++){var w=m+4*y;g+=t[f]*i[w],f++}o[h]=g/n}}o[4*(u*r+v)+3]=255}return s}}]),t}();e.default=r},function(t,e){t.exports='<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <meta name="viewport" content="width=device-width">\r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">\r\n    <title>Canvas Images Processing</title>\r\n</head>\r\n<body>\r\n<header>\r\n    <div class="container">\r\n        <h1>基于canvas的图像处理</h1>\r\n        <p>像素级操作，Web也能玩转图片&nbsp;&nbsp;&nbsp; @Ytime</p>\r\n    </div>\r\n</header>\r\n\x3c!--预置滤镜--\x3e\r\n<nav class="preset">\r\n    <div class="container">\r\n        <ul id="filter-li" class="clear">\r\n            <li data-filter="getImageData">原图</li>\r\n            <li data-filter="greyScale">灰度</li>\r\n            <li data-filter="black">黑白</li>\r\n            <li data-filter="comic">连环画</li>\r\n            <li data-filter="sepia">怀旧</li>\r\n            <li data-filter="invert">底片</li>\r\n            <li data-filter="brightness">加亮</li>\r\n            <li data-filter="sharpen">锐化</li>\r\n            <li data-filter="edgeDetection">边缘检测</li>\r\n            <li data-filter="embossing">浮雕</li>\r\n            <li data-filter="gaussBlur">模糊</li>\r\n            <li data-filter="sketch">素描</li>\r\n\r\n        </ul>\r\n    </div>\r\n</nav>\r\n\r\n\x3c!--图片显示--\x3e\r\n<div id="wrapper" class="container content" title="拖拽新图片替换" droppable="true">\r\n    <canvas id="canvas" class="init">您的浏览器不支持canvas，请更换现代浏览器</canvas>\r\n    <div class="tip">\r\n        <span>把图片拖拽到此处</span>\r\n    </div>\r\n    \x3c!--卷积矩阵--\x3e\r\n    <div class="mat-con" id="mat-con">\r\n        <div>\r\n            <input type="text" value="0"><input type="text" value="0"><input type="text" value="0"><input type="text" value="0"><input type="text" value="1"><input type="text" value="0"><input type="text" value="0"><input type="text" value="0"><input type="text" value="0">\r\n        </div>\r\n        <div><button id="apply-btn" title="矩阵卷积滤波">应用</button></div>\r\n    </div>\r\n</div>\r\n\r\n</body>\r\n</html>'}]);
//# sourceMappingURL=bundle.065128fd69f5298667c3.js.map